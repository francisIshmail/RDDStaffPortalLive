<!DOCTYPE html>

<html>
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">

    @*<title>@ViewBag.Title </title>*@

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    @*<link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-grid.min.css" rel="stylesheet">
        <link href="css/bootstrap-reboot.min.css" rel="stylesheet">*@
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/bootstrap-grid.min.css" rel="stylesheet" />
    <link href="~/Content/bootstrap-reboot.min.css" rel="stylesheet" />
    <link href="~/Content/style.css" rel="stylesheet" />
    <link href="~/Content/atlantis.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Content/reddot.css">
    <link href="~/Content/reddot.css" rel="stylesheet" />

    <link href="~/Scripts/sweetalret/sweetalert2.min.css" rel="stylesheet" />
    <link href="~/Scripts/datapicker-separate/daterangepicker.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <style>
        th.month {
            margin: 0px;
            padding: 0px;
        }

        .info-section {
            max-height: 250px;
            overflow: auto;
        }


        .scrollbar {
            margin-left: 30px;
            float: left;
            height: 300px;
            width: 65px;
            background: #F5F5F5;
            overflow-y: scroll;
            margin-bottom: 25px;
        }

        .force-overflow {
            min-height: 450px;
        }


        /*
        *  STYLE 1
        */

        .style-1::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
            border-radius: 10px;
            background-color: #F5F5F5;
        }

        .style-1::-webkit-scrollbar {
            width: 12px;
            background-color: #F5F5F5;
        }

        .style-1::-webkit-scrollbar-thumb {
            border-radius: 10px;
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
            background-color: #555;
        }

       
        .unread {
            color: blue !important;
            font-weight: 600;
        }

        .read {
            background: #f7f6f6;
        }

        .unread-notify {
            position: absolute;
            left: 41px;
            /* top: 37px; */
            color: #31e526;
            font-size: 11px;
            margin-bottom: -27px;
            /* bottom: 10px; */
        }
    </style>
   
</head>
<body>
    <nav class="p-0 navbar navbar-expand-md fixed-top navbar-dark bg-white border-bottom box-shadow">
        <button class="navbar-toggler p-3 border-0" type="button" data-toggle="offcanvas">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse offcanvas-collapse justify-content-center p3" id="navbarsExampleDefault">
            <ul class="navbar-nav">
                <li class="p-3 nav-item">
                    <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LeaveApproval/Index">Dashboard <span class="sr-only">(current)</span></a>
                </li>
                <li class="p-3 nav-item">
                    <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_AnnualLeaveCalender/Index">Planner</a>
                </li>
                <li class="p-3 nav-item">
                    <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LeaveRequest/Index">Apply Leave</a>
                </li>

                @if (User.IsInRole("HR"))
                {
                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LeaveType/Index">Leave Type</a>
                    </li>

                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LeaveAdjustment/Index">Adjustment</a>
                    </li>
                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LMSReport/Index">Report I</a>
                    </li>
                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_HRLMSReport/Index">Report II</a>
                    </li>
                }

                @if (User.IsInRole("LocalHR"))
                {
                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_LMSReport/Index">Report I</a>
                    </li>
                    <li class="p-3 nav-item">
                        <a class="nav-link text-dark font-weight-normal" href="~/LMS/RDD_HRLMSReport/Index">Report II</a>
                    </li>
                }

                <li class="p-3 nav-item">
                    <a class="nav-link text-dark font-weight-normal" href="~/Dashboard/IndexNew">Main Dashboard</a>
                </li>
            </ul>
        </div>
        <nav class="navbar navbar-header navbar-expand-lg">

            <div class="container-fluid">
                <ul class="navbar-nav topbar-nav ml-md-auto align-items-center">
                    @{ Html.RenderAction("_PartialLoginUserProfile", "Dashboard", new { area = "" });}
                </ul>
            </div>
        </nav>
    </nav>

    <div>
        @RenderBody()
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script>
        WebFont.load({
            google: {
                families: ['PT+Sans:400,400i,700,700i', 'Lato:100,100i,300,300i,400,400i,700,700i,900,900i', 'Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i']
            }
        });
    </script>
    <!--   Core JS Files   -->
    @*<script src="~/js/core/jquery.3.2.1.min.js"></script>*@
    @*<script src="~/Scripts/jquery-3.5.1.min.js"></script>*@
    <script src="@Url.Content("~/Scripts/jquery-3.5.1.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery.signalR-2.4.1.min.js")"></script>
    <script src="/signalr/hubs"></script>
    <script type="text/javascript">

        // GET NOTIFICATIONS AND SETUP SIGNALR
        debugger
        console.log("signalr");
        updateNotification('Old');
        // Click on notification icon to show notification
        $("#notifDropdown").click(function (e) {

            e.stopPropagation();
            $('.notif-box').show();
        });
        //$("#notiContent").click(function () {
        //    count = parseInt($('span.notification').html()) || 0;
        //    if (count > 0) {

        //        $.ajax({
        //            async: false,
        //            cache: false,
        //            type: "POST",
        //            url: '/Dashboard/SetNotification_Status_Chnage',
        //            contentType: "application/json",
        //            dataType: "json",
        //            success: function (response) {
        //                debugger
        //            },
        //            error: function (error) {
        //                console.log(error);
        //            }
        //        });
        //    }})

        // Hide notifications
        $('html').click(function () {
            $('.notif-box').hide();
        });

        // Update notifications
        function updateNotification(Flag) {
            $.ajax({
                async: false,
                cache: false,
                type: "POST",
                data: JSON.stringify({
                    Flag: Flag
                }),
                url: '/Dashboard/GetNotificationContacts',
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    debugger
                    //$('#notiContent').append($('<li>Loading...</li>'));
                    // $('#notiContent').empty();
                    var found_names = response.Table;
                    var found_names_unread = $.grep(response.Table, function (v) {
                        return v.Notification_Status.toUpperCase() !== 'READ';
                    });
                    if (found_names.length === 0) {
                        $('#notiContent').empty();
                        $('#notiContent').append($('<li class="see-all">No data available</li>'));
                        $(".notif-box").find("a").hide();
                    } else {
                        //$('#notiContent').empty();
                        $(".notif-box").find("a").show();
                    }
                    count = parseInt($('span.notification').html()) || 0;
                    if (count < found_names.length) {
                        $('span.notif-box').css("color", "");
                        $('span.notification').css({ "background-color": "", "color": "" });
                    } else {
                        //$('span.notif-box').css("color", "white");
                        //$('span.notification').css({ "background-color": "red", "color": "white" });
                        return
                    }

                    $(".notification").html(found_names_unread.length);
                    $("#dropdown-title").html("You have " + found_names_unread.length + " new notification");
                    $('#notiContent').append($('<li>Loading...</li>'));
                    $('#notiContent').empty();

                    $.each(found_names, function (index, value) {


                        if (value.Notification_Status.toUpperCase() !== 'READ') {


                            $('#notiContent').append($(' <a href="' + value.REf_URL + '">' +
                                '<div class="notif-icon notif-primary" style="min-width:40px"> <i class="' + value.Notification_Icon + '" aria-hidden="true"></i> <i class="fa fa-circle unread-notify" aria-hidden="true"></i></div>' +
                                '<div class="notif-content">' +
                                '<span class="block">' +
                                '' + value.Notification_Text + '' +
                                '</span>' +
                                ' <span class="time unread">' + value.duration + ' ago</span>' +
                                //' <span><i class="fa fa-circle unread-notify" aria-hidden="true"></i></span>' +
                                ' </div>' +
                                '</a>'));
                        }
                        else {
                            $('#notiContent').append($(' <a href="' + value.REf_URL + '">' +
                                '<div class="notif-icon notif-success" style="min-width:40px"> <i class="' + value.Notification_Icon + '" aria-hidden="true"></i> </div>' +
                                '<div class="notif-content">' +
                                '<span class="block">' +
                                '' + value.Notification_Text + '' +
                                '</span>' +
                                ' <span class="time">' + value.duration + ' ago</span>' +

                                ' </div>' +
                                '</a>'));
                        }

                    });

                },
                error: function (error) {
                    console.log(error);
                }
            });
        }
        $(function () {
            debugger


        })
        // SignalR js code for start hub and send receive notification(s) from the server side
        var notificationHub = $.connection.notificationHub;
        $.connection.hub.start().done(function () {
            console.log('Notification hub started');
        });

        // SignalR method for push server message to client
        notificationHub.client.notify = function (message) {
            debugger
            var count = 0, Count1 = 0;
            if (message && message.toLowerCase() === "added") {
                console.log('Notification hub added');
                // count = parseInt($('span.notification').html()) || 0;
                updateNotification('New');
                //count1 = parseInt($('span.notification').html()) || 0;
                //if (count < count1) {
                //    $('span.notif-box').css("color", "white");
                //    $('span.notification').css({ "background-color": "red", "color": "white" });
                //}
            }
            //else if (message && message.toLowerCase() === "updated") {
            //    console.log('Notification hub Approver');
            //    count = parseInt($('span.notification').html()) || 0;
            //    updateNotification('New');
            //    count1 = parseInt($('span.notification').html()) || 0;
            //    if (count<count1) {
            //        $('span.notif-box').css("color", "white");
            //        $('span.notification').css({ "background-color": "red", "color": "white" });
            //    }

            //}
        };
        function updateNotificationCount() {
            debugger
            $('span.notification').show();
            var count = 0;
            count = parseInt($('span.notification').html()) || 0;
            count++;
            $('span.notif-box').css("color", "white");
            $('span.notification').css({ "background-color": "red", "color": "white" });
            $('span.notification').html(count);

        }

        // signalr js code for start hub and send receive notification


    </script>
    <script src="~/js/core/popper.min.js"></script>
    <script src="~/js/core/bootstrap.min.js"></script>
    @*Select2*@
    <script src="~/js/plugin/select2/select2.full.min.js"></script>
    <!-- jQuery UI -->
    <script src="~/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
    <script src="~/js/plugin/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js"></script>

    <!-- Moment JS -->
    @*<script src="~/js/plugin/moment/moment.min.js"></script>*@
    <script src="~/js/plugin/moment/moment.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.js"></script>


    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/holder.min.js"></script>
    <script src="~/Scripts/offcanvas.js"></script>
    <!-- DateTimePicker -->
    <script src="~/js/plugin/datepicker/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Scripts/datapicker-separate/daterangepicker.js"></script>
    <!-- jQuery Scrollbar -->
    <script src="~/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
    <!-- Atlantis JS -->
    <script src="~/js/atlantis.min.js"></script>

    <script src="~/Scripts/sweetalret/sweetalert2.all.min.js"></script>
    <script src="~/Scripts/RedDotUtility.js"></script>

    @{
        var conf = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath);
        var section = (System.Web.Configuration.SessionStateSection)conf.GetSection("system.web/sessionState");

        string timeout = section.Timeout.TotalMinutes.ToString();
    }

    <link href="~/Content/timeout-dialog.css" rel="stylesheet" />
    <script src="~/Scripts/timeout-dialog.js"></script>

    <script>
             $(function () {
            Timer();
            });
        function Timer() {
            //console.log("Set Timeout");
            setTimeout(TimeOut, 10000);
        }
        function TimeOut() {
            $.timeoutDialog({
                timeout: @timeout*60,
                countdown: 20,
                keep_alive_url: '@Url.Action("Keepalive", "Account", new { area = "" })',
                logout_redirect_url: '@Url.Action("SignOut", "Account", new { area = "" })',
                logout_url: '@Url.Action("SignOut", "Account", new { area = "" })',
                restart_on_yes: true
            });


            //$(document).on('mousemove keypress :not(#timeout-dialog)', function () {
            //    clearTimeout();
            //    Timer();

            //});

        }
    </script>
</body>
</html>
<!--   Core JS Files   -->







