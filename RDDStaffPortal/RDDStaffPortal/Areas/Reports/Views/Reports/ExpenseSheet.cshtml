@model RDDStaffPortal.DAL.DataModels.Report.RDD_Expense

@{
    ViewBag.Title = "ExpenseSheet";
    Layout = "~/Views/Shared/_CommonLayout.cshtml";
}

<div class="main-panel">
    <div class="container">
        <div class="page-inner">

            <div class="page-header">
                <div class="col-md-9 padd-0">
                    <h4 class="page-title">Expense Report</h4>
                </div>
                <div class="col-md-1 ml-auto text-right"><button class="btn btn-info btn-sm" id="FilterBtn"><span class="btn-label"> </span> <i class="fas fa-filter"></i></button></div>

            </div>



            <div class="rowmin" id="FilterSection" style="display:none">

                <div class="col-md-12">
                    <div class="card full-height padd-10">
                        <div class="row">

                            <div class="col-xl-3 col-md-3" id="SourceDb1">
                                <div class="form-group">
                                    <label for="email2" class="width100px">Source DB :</label>
                                    @Html.DropDownListFor(m => m.SourceDb, ViewBag.SourceDbList as SelectList, "-Select-", new { @class = "form-control form-control-sm" })
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-3" id="Project1">
                                <div class="form-group">
                                    <label for="email2" class="width100px">Project  :</label>
                                    @Html.DropDownListFor(m => m.Project, ViewBag.ProjectList as SelectList, "-Select-", new { @class = "form-control form-control-sm" })
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-3" id="Country1">
                                <div class="form-group">
                                    <label for="email2" class="width100px">Country :</label>
                                    @Html.DropDownListFor(m => m.Country, ViewBag.CountryList as SelectList, "-Select-", new { @class = "form-control form-control-sm" })
                                </div>
                            </div>
                        </div>


                        <div class="row">

                            <div class="col-xl-3 col-md-3" id="Year1">
                                <div class="form-group">
                                    <label for="email2" class="width100px">Year :</label>
                                    @Html.DropDownListFor(m => m.Year, ViewBag.YearList as SelectList, "-Select-", new { @class = "form-control form-control-sm" })
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-3" id="month1">
                                <div class="form-group">
                                    <label for="email2" class="width100px">Month :</label>
                                    @Html.DropDownListFor(m => m.month, ViewBag.MonthList as SelectList, "-Select-", new { @class = "form-control form-control-sm" })
                                </div>
                            </div>
                           
                            <div class="row">


                                <div class="col-xl-1 col-md-1 ml-auto">
                                    <div class="form-group">
                                        <label for="email2" class="width100px"></label>
                                        <button class="btn btn-info btn-sm" id="btnApply">Apply</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
            <div class="rowmin">
                <div class="col-md-12">
                    <div class="card full-height">
                        <div class="card-body">
                            <div class="rowmin row mar-b10">


                                <div class="col-xl-4 col-md-4">
                                    <div class="form-group">
                                        <input type="text" placeholder="Search" class="form-control form-control-sm" id="Search-Forms-QuickLinks">
                                    </div>
                                </div>


                                <div class="col-xl-2 col-md-2 ml-auto text-right">
                                    <div class="form-group">

                                        <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#SelectWidgetspopup" title="Hide Column"><i href="#" class="fas fa-minus-circle"></i></button>

                                        <a href="/Reports/Reports/DownloadToExcel4" title="Export to Excel" class="excel-btn"><i class="fas fa-file-excel"></i></a>

                                        @*onclick="exportToExcel()"*@

                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <div class="reddotTable sm-form mar-t0">
                                    <div class="loader1"></div>
                                    <div id="Ind" class="reddotTableBody">
                                        <div class="reddotTableRow odd-even-row">

                                            <div class="reddotTableHead"><div>SourceDb</div></div>
                                            <div class="reddotTableHead"><div> SourceDbCode</div></div>
                                            <div class="reddotTableHead"><div> AcctCode</div></div>
                                            <div class="reddotTableHead"><div>Acct</div></div>
                                            <div class="reddotTableHead"><div> TransId</div></div>
                                            <div class="reddotTableHead"><div>TransType</div></div>
                                            <div class="reddotTableHead"><div>Refrence</div></div>

                                            <div class="reddotTableHead"><div> TxDate</div></div>
                                            <div class="reddotTableHead"><div> Year</div></div>
                                            <div class="reddotTableHead"><div> Qtr</div></div>
                                            <div class="reddotTableHead"><div> month</div></div>
                                            <div class="reddotTableHead"><div> weekNo</div></div>
                                            <div class="reddotTableHead"><div> Project</div></div>
                                            <div class="reddotTableHead"><div>Country</div></div>
                                            <div class="reddotTableHead"><div> Rate</div></div>
                                            <div class="reddotTableHead"><div> DebitLC</div></div>
                                            <div class="reddotTableHead"><div> DebitFC</div></div>

                                            <div class="reddotTableHead"><div>DebitSC </div></div>
                                            <div class="reddotTableHead"><div> CreditLC</div></div>
                                            <div class="reddotTableHead"><div>CreditFC</div> </div>
                                            <div class="reddotTableHead"><div>TotalLC</div> </div>
                                            <div class="reddotTableHead"><div>TotalFC </div></div>
                                            <div class="reddotTableHead"><div>TotalSC</div></div>
                                            <div class="reddotTableHead"><div>Remarks</div></div>
                                        </div>
                                    </div>
                                    <div id="Ibody" class="reddotTableBody">
                                        <div id="Ist" class="reddotTableRow odd-even-row">
                                            <div class="reddotTableCell Abcd"><div></div></div>
                                            <div class="reddotTableCell Abcd"><div></div></div>
                                            <div class="reddotTableCellLeft Abcd"><div></div></div>
                                            <div class="reddotTableCellLeft Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellLeft Abcd"><div></div></div>
                                            <div class="reddotTableCellLeft Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellRight Abcd"><div></div></div>
                                            <div class="reddotTableCellLeft Abcd"><div></div></div>


                                        </div>
                                    </div>
                                </div>
                                                    <div class="row mar-t10">
                                                        <nav aria-label="Page navigation example">
                                                            <ul class="pagination mar-b0">
                                                                <li class="page-item prev"><a class="page-link" href="#">Previous</a></li>

                                                                <li class="page-item next"><a class="page-link" href="#">Next</a></li>
                                                            </ul>
                                                        </nav>
                                                    </div>
                                                </div>

                                            </div>
                                                </div>
                                            </div>
                                                </div>
                                            </div>
                                                </div>
                                            </div> 
                                                    <!-- Modal -->
                                                    <div class="modal fade" id="SelectWidgetspopup" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" keyboard="false" data-backdrop="static">
                                                        <div class="modal-dialog modal-lg" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLongTitle">Show/Hide Columns</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body selectwidget-section">
                                                                    <div class="row rowmin" id="idchk">
                                                                        @*<div class="col-md-12 mar-b10">
                                    <div class="row" id="idchk"> </div>
                                </div>*@
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button id="btnsave" type="button" class="btn btn-info btn-sm">Apply</button>
                                                                    <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
                                                    <script>
    var tblhead1 = ['SourceDb', 'SourceDbCode', 'AcctCode', 'Acct', 'TransId', 'TransType', 'Refrence', 'TxDate', 'Year', 'Qtr', 'month', 'weekNo', 'Project', 'Country', 'Rate', 'DebitLC', 'DebitFC', 'DebitSC', 'CreditLC', 'CreditFC', 'TotalLC', 'TotalFC', 'TotalSC', 'Remarks'];
                                                        var tblhide = [];
                                                        var tblhead2 = ['AcctCode', 'Acct', 'TransId', 'TransType', 'TxDate', 'WeekNo', 'Project'];

    $(".loader1").hide();

    //function startLoader() {
    //    $("#btnExport").text('Loading..');
    //    $("#btnExport").attr('disabled',true);
    //}
    //function stopLoader() {
    //    $("#btnExport").text('Export..');
    //    $("#btnExport").attr('disabled', false);
    //}
    function exportToExcel() {
        $.ajax({
            type: "GET",
            contentType: "application/json; charset=utf-8",
            url: '@Url.Action("DownloadToExcel1", "Reports")',
            beforeSend: function () {
                $(".loader1").show();
            },
            success: function (response) {
                var blob = new Blob([response], { type: 'application/ms-excel;charset=utf-8' });
                var downloadUrl = URL.createObjectURL(blob);
                var a = document.createElement("a");
                a.href = downloadUrl;
                a.download = "ReportFile.xls";
                document.body.appendChild(a);
                a.click();
            },
            complete: function () {
                $(".loader1").hide();
            },
            error: function () {

            }
        });
        return false;
    }
    $(document).ready(function () {
        $(".loader1").show();
        var k1 = 0;
        while (tblhead1.length > k1) {
            debugger
            var ab = "<div class='col-md-3 mar-b10'><div class='panel'><div class='row'><div class='col-sm-10 col-md-10'><div class='widget-content padd-0'><span class='widget-name'> " + tblhead1[k1] + "</span></div></div><div class='col-sm-2 col-md-2 ml-auto'><label class='colorinput mar-t6 mar-b0'><input id='ChkDash' type='checkbox' class='colorinput-input'><span class='colorinput-color bg-secondary'></span><div> </label></div></div></div></div></div>";
            if (jQuery.inArray(tblhead1[k1], tblhide) !== -1) {
              //$("#idchk").append(" <div class='col-sm-1 col-md-1 text-right'><input id='" + tblhead1[k1]+"' type='checkbox' ></div><div class='col-sm-2 col-md-2'>" + tblhead1[k1] + "</div> ");
                $('div#' + tblhead1[k1] + '1').addClass("Abc");
                $("#idchk").append("<div class='col-md-3 mar-b10'><div class='panel'><div class='row'><div class='col-sm-10 col-md-10'><div class='widget-content padd-0'><span class='widget-name'> " + tblhead1[k1] + "</span></div></div><div class='col-sm-2 col-md-2 ml-auto'><label class='colorinput mar-t6 mar-b0'><input id='" + tblhead1[k1] +"' type='checkbox' class='colorinput-input'><span class='colorinput-color bg-secondary'></span><div> </label></div></div></div></div></div>");
            } else {
                if (jQuery.inArray(tblhead1[k1], tblhead2) == -1) {
                    $('div#' + tblhead1[k1] + '1').removeClass("Abc");
                    $("#idchk").append("<div class='col-md-3 mar-b10'><div class='panel'><div class='row'><div class='col-sm-10 col-md-10'><div class='widget-content padd-0'><span class='widget-name'> " + tblhead1[k1] + "</span></div></div><div class='col-sm-2 col-md-2 ml-auto'><label class='colorinput mar-t6 mar-b0'><input id='" + tblhead1[k1] + "' type='checkbox' class='colorinput-input' checked><span class='colorinput-color bg-secondary'></span><div> </label></div></div></div></div></div>");
                }
            }
            k1++;
        }

        $('#Country').select2({
            theme: "bootstrap",
            allowClear: true,
            placeholder: '--Select Country--'
        });
        $('#Project').select2({
            theme: "bootstrap",
            allowClear: true,
            placeholder: '--Select Project--'
        });

        $('#SourceDb').select2({
            theme: "bootstrap",
            allowClear: true,
            placeholder: '--Select Source DB--'
        });

        $('#Month').select2({
            theme: "bootstrap",
            allowClear: true,
            placeholder: '--Select Month--'
        });
        $('#Year').select2({
            theme: "bootstrap",
            allowClear: true,
            placeholder: '--Select Year--'
        });


        $("#FilterBtn").click(function () {
            $("#FilterSection").slideToggle("slow");

        });
        var value1 = $("#Search-Forms-QuickLinks").val().toLowerCase();
        var arr = [];
        var curPage = 1;

        $.ajax({
            type: "POST",
            url: "/Reports/Reports/ExpenseSheetReport",
            contentType: "application/json",
            dataType: "json",
            data: JSON.stringify({
                pagesize: 50,
                pageno: curPage,
                psearch: value1,
                Country: $("#Country").val(),
                Project: $("#Project").val(),
                SourceDb: $("#SourceDb").val(),
                Month: $("#month").val(),
                year: $("#Year").val()
            }),
            success: function (data) {
                debugger
                $("#Ist").show();
                arr = data;
                if (arr.data != null && arr.data.length != 0) {
                    var i = 0;
                    while (arr.data.length > i) {
                        var tr = $("#Ist").clone();
                        var tr1 = $("#Ind").closest();
                        var k = 0;
                        var l1 = tr.find(".Abcd").length;
                        while (l1 > k) {
                            if (tblhead1[k] == 'TxDate') {
                                tr.find(".Abcd")[k].children[0].textContent =RdotdatefrmtRes1(arr.data[i][tblhead1[k]]);
                            } else {
                                tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                            }
                            
                            var t = tblhead1[k];

                            if (jQuery.inArray(t, tblhide) !== -1) {
                                tr.find(".Abcd").eq(k).addClass("Abc")
                                tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc")
                            }

                            k++;
                        }
                        $("#Ibody").append(tr);
                        i++;
                    }
                    $("#Ist")[0].remove();
                } else {
                    $("#Ist").hide();
                    RedDotAlert_Error("No Record Found");
                }
            }
            , complete: function () {
                $(".loader1").hide();
            }
        });

        $("#btnApply").on("click", function () {
            $(".loader1").show();
            $.ajax({
                type: "POST",
                url: "/Reports/Reports/ExpenseSheetReport",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({
                    pagesize: 50,
                    pageno: curPage,
                    psearch: $("#Search-Forms-QuickLinks").val(),
                    Country: $("#Country").val(),
                    Project: $("#Project").val(),
                    SourceDb: $("#SourceDb").val(),
                    Month: $("#month").val(),
                    year: $("#Year").val()
                }),
                success: function (data) {
                    $("#Ist").show();
                    $("div#Ist").not(':first').remove();
                    arr = data;
                    if (arr.data != null && arr.data.length != 0) {
                        var i = 0;
                        while (arr.data.length > i) {
                            var tr = $("#Ist").clone();
                            var tr1 = $("#Ind").closest();
                            var k = 0;
                            var l1 = tr.find(".Abcd").length;
                            while (l1 > k) {
                                tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                                var t = tblhead1[k];
                                debugger
                                if (jQuery.inArray(t, tblhide) !== -1) {
                                    tr.find(".Abcd").eq(k).addClass("Abc")
                                    tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc")
                                }
                                k++;
                            }
                            $("#Ibody").append(tr);
                            i++;
                        }
                        $("#Ist")[0].remove();
                    } else {
                        $("#Ist").hide();
                        RedDotAlert_Error("No Record Found");
                    }
                }, complete: function () {
                    $(".loader1").hide();
                }
            });
        });

        $("#btnsave").on("click", function () {
            debugger
            $(".loader1").show();
            tblhide = [];
            $('input:checkbox').each(function () {

                var IsActiveTxt = $(this).is(":checked");
                if (IsActiveTxt == false && $(this).attr("id") != undefined) {

                    tblhide.push($(this).attr("id"));
                    $('div#' + $(this).attr("id") + '1').addClass("Abc");
                } else {
                    $('div#' + $(this).attr("id") + '1').removeClass("Abc");
                }
                $("select").val('').trigger('change');
            });

            $.ajax({
                type: "POST",
                url: "/Reports/Reports/ExpenseSheetReport",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({
                    pagesize: 50,
                    pageno: curPage,
                    psearch: value1,
                    Country: $("#Country").val(),
                    Project: $("#Project").val(),
                    SourceDb: $("#SourceDb").val(),
                    Month: $("#month").val(),
                    year: $("#Year").val()
                }),
                success: function (data) {
                    $("div#Ist").not(':first').remove();
                    $("#Ist").show();
                    arr = data;
                    if (arr.data != null && arr.data.length != 0) {
                        var i = 0;
                        while (arr.data.length > i) {
                            var tr = $("#Ist").clone();
                            var tr1 = $("#Ind").closest();
                            var k = 0;
                            var l1 = tr.find(".Abcd").length;
                            while (l1 > k) {
                                if (tblhead1[k] == 'TxDate') {
                                    tr.find(".Abcd")[k].children[0].textContent = RdotdatefrmtRes1(arr.data[i][tblhead1[k]]);
                                } else {
                                    tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                                }
                                var t = tblhead1[k];
                                if (jQuery.inArray(t, tblhide) !== -1) {
                                    debugger
                                    tr.find(".Abcd").eq(k).addClass("Abc");
                                    tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc");
                                } else {
                                    tr.find(".Abcd").eq(k).removeClass("Abc");
                                    tr1.prevObject.find(".reddotTableHead").eq(k).removeClass("Abc");
                                }

                                k++;
                            }
                            $("#Ibody").append(tr);

                            i++;
                        }

                        $("#Ist")[0].remove();
                        $('.close').trigger("click");
                    } else {
                        $("#Ist").hide();
                        RedDotAlert_Error("No Record Found");
                    }
                }, complete: function () {
                    $(".loader1").hide();
                }
            });

        })

        $('.next').bind('click', function () {


            curPage++;
            if (curPage > arr.data[0].TotalCount)
                curPage = 0;
            $.ajax({
                type: "POST",
                url: "/Reports/Reports/ExpenseSheetReport",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({
                    pagesize: 50,
                    pageno: curPage,
                    psearch: value1,
                    Country: $("#Country").val(),
                    Project: $("#Project").val(),
                    SourceDb: $("#SourceDb").val(),
                    Month: $("#month").val(),
                    year: $("#Year").val()
                }),
                success: function (data) {

                    $("#Ist").show();
                    $("div#Ist").not(':first').remove();
                    arr = data;
                    if (arr.data != null && arr.data.length != 0) {
                        var i = 0;
                        while (arr.data.length > i) {
                            var tr = $("#Ist").clone();
                            var tr1 = $("#Ind").closest();
                            var k = 0;
                            var l1 = tr.find(".Abcd").length;
                            while (l1 > k) {
                                if (tblhead1[k] == 'TxDate') {
                                    tr.find(".Abcd")[k].children[0].textContent = RdotdatefrmtRes1(arr.data[i][tblhead1[k]]);
                                } else {
                                    tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                                }
                                var t = tblhead1[k];
                                debugger
                                if (jQuery.inArray(t, tblhide) !== -1) {
                                    tr.find(".Abcd").eq(k).addClass("Abc")
                                    tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc")
                                }
                                k++;
                            }
                            $("#Ibody").append(tr);
                            i++;
                        }


                        $("#Ist")[0].remove();
                    } else {
                        $("#Ist").hide();
                        RedDotAlert_Error("No Record Found");
                    }

                }
                , complete: function () {
                    $(".loader1").hide();

                }
            });
        });

        $('.prev').bind('click', function () {
            $(".loader1").show();
            curPage--;
            if (curPage < 0)
                curPage = (arr.data[0].TotalCount - 1);
            $.ajax({
                type: "POST",
                url: "/Reports/Reports/ExpenseSheetReport",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({
                    pagesize: 50,
                    pageno: curPage,
                    psearch: value1,
                    Country: $("#Country").val(),
                    Project: $("#Project").val(),
                    SourceDb: $("#SourceDb").val(),
                    Month: $("#month").val(),
                    year: $("#Year").val()
                }),
                success: function (data) {
                    $("#Ist").show();
                    $("div#Ist").not(':first').remove();
                    arr = data;
                    if (arr.data != null && arr.data.length != 0) {
                        var i = 0;
                        while (arr.data.length > i) {
                            var tr = $("#Ist").clone();
                            var tr1 = $("#Ind").closest();
                            var k = 0;
                            var l1 = tr.find(".Abcd").length;
                            while (l1 > k) {
                                if (tblhead1[k] == 'TxDate') {
                                    tr.find(".Abcd")[k].children[0].textContent = RdotdatefrmtRes1(arr.data[i][tblhead1[k]]);
                                } else {
                                    tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                                }
                                var t = tblhead1[k];
                                debugger
                                if (jQuery.inArray(t, tblhide) !== -1) {
                                    tr.find(".Abcd").eq(k).addClass("Abc")
                                    tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc")
                                }
                                k++;
                            }
                            $("#Ibody").append(tr);
                            i++;
                        }
                        $("#Ist")[0].remove();
                    } else {
                        $("#Ist").hide();
                        RedDotAlert_Error("No Record Found");
                    }
                }
                , complete: function () {
                    $(".loader1").hide();

                }
            });
        });


        $("#Search-Forms-QuickLinks").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $(".loader1").show();
            $.ajax({
                type: "POST",
                url: "/Reports/Reports/ExpenseSheetReport",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({
                    pagesize: 50,
                    pageno: curPage,
                    psearch: value,
                    Country: $("#Country").val(),
                    Project: $("#Project").val(),
                    SourceDb: $("#SourceDb").val(),
                    Month: $("#month").val(),
                    year: $("#Year").val()
                }),
                success: function (data) {
                    $("#Ist").show();
                    $("div#Ist").not(':first').remove();
                    arr = data;
                    if (arr.data != null && arr.data.length != 0) {
                        var i = 0;
                        while (arr.data.length > i) {
                            var tr = $("#Ist").clone();
                            var tr1 = $("#Ind").closest();
                            var k = 0;
                            var l1 = tr.find(".Abcd").length;
                            while (l1 > k) {
                                if (tblhead1[k] == 'TxDate') {
                                    tr.find(".Abcd")[k].children[0].textContent = RdotdatefrmtRes1(arr.data[i][tblhead1[k]]);
                                } else {
                                    tr.find(".Abcd")[k].children[0].textContent = arr.data[i][tblhead1[k]];
                                }
                                var t = tblhead1[k];
                                debugger
                                if (jQuery.inArray(t, tblhide) !== -1) {
                                    tr.find(".Abcd").eq(k).addClass("Abc")
                                    tr1.prevObject.find(".reddotTableHead").eq(k).addClass("Abc")
                                }
                                k++;
                            }
                            $("#Ibody").append(tr);
                            i++;
                        }
                        $("#Ist")[0].remove();
                    } else {
                        $("#Ist").hide();
                        RedDotAlert_Error("No Record Found");
                    }
                },
                complete: function () {
                    $(".loader1").hide();
                }
            });
        });
        //$(".fa-file-excel").on("click", function () {
        //    debugger
        //    $(".loader1").show();
        //    $.post("/DownloadExcelTes").done(function (response) {
        //        $(".loader1").hide();
        //    })
        //})
    });
                                                    </script>
                                                    <style>
                                                        .Abc {
                                                            display: none !important;
                                                        }
                                                    </style>
